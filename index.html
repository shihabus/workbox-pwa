<!DOCTYPE html>
<html lang="en">

<head>
    <link rel="manifest" href="/manifest.json">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="./main.css">
</head>

<body>
    <h1>Our users</h1>
    <button id="btnAdd">Install</button>

    <ul id="people"></ul>

    <script async src="./app.js"></script>
    <script>
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('/sw.js')
                    .then(reg => {
                        console.log('Registered', reg)
                    }).catch(err => {
                        console.log('Registration failed', err)
                    })
            });
        }

        let deferredPrompt;

        window.addEventListener('beforeinstallprompt', (e) => {
            // Prevent the mini-infobar from appearing on mobile
            e.preventDefault();
            // Stash the event so it can be triggered later.
            deferredPrompt = e;
            // Update UI notify the user they can install the PWA
            btnAdd.addEventListener('click', e => {
                deferredPrompt.prompt()
                deferredPrompt.userChoice.then(choiceResult => {
                    console.log('choiceResult', choiceResult)
                    if (choiceResult.outcome === 'accepted') {
                        console.log('User accepted the A2HS prompt')
                    }
                    deferredPrompt = null
                })
            })
        });




        window.addEventListener('appinstalled', e => {
            console.log('App installed')
        })
    </script>
</body>

</html>